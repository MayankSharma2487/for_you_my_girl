<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Our Gallery üíñ</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    /* ---------------------
       Mobile-first (2 columns)
       --------------------- */
    :root{
      --bg1:#ffb6c1;
      --bg2:#ffe4e1;
      --accent1:#ff4d88;
      --accent2:#ff1493;
      --text-dark:#3a2a3a;
      --card-radius:14px;
      --gutter:12px;
      --top-space: calc(1.25rem + env(safe-area-inset-top, 0px));
    }

    html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
    body{
      background:linear-gradient(135deg,var(--bg1),var(--bg2));
      color:var(--text-dark);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      -webkit-text-size-adjust:100%;
    }

    /* page shell with extra safe top padding so heading never clips */
    .gallery-wrap{
      min-height:100vh;
      padding: var(--top-space) 16px 48px;
      box-sizing:border-box;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:12px;
      text-align:center;
    }

    /* header */
    .gallery-title{
      font-weight:700;
      font-size:clamp(1.4rem,6.2vw,1.95rem);
      line-height:1.05;
      margin:0;
      background:linear-gradient(90deg,#ff007f,#ff66b2);
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
      text-shadow: 0 0 0 rgba(0,0,0,0.0); /* keep accessible if background-clip unsupported */
    }
    .gallery-sub{
      margin:0;
      color:#7a006a;
      font-size:clamp(.9rem,3.6vw,1rem);
    }

    .back-btn{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 20px;
      border-radius:999px;
      background:linear-gradient(90deg,var(--accent1),var(--accent2));
      color:#fff;
      text-decoration:none;
      box-shadow:0 8px 20px rgba(255,105,180,.25);
      font-weight:600;
      margin-top:6px;
      touch-action: manipulation;
    }

    /* grid: default two columns on phones (per your requirement) */
    .grid{
      width:100%;
      max-width:1100px;
      display:grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--gutter);
      margin-top:6px;
      align-items:start;
    }

    /* card: use aspect-ratio so all look consistent */
    .card{
      background:#fff;
      border-radius:var(--card-radius);
      overflow:hidden;
      box-shadow:0 6px 18px rgba(0,0,0,.08);
      position:relative;
      touch-action: manipulation;
    }
    .card:active { transform: translateY(1px); }
    .card .imgwrap{
      width:100%;
      aspect-ratio: 1/1; /* square cards; change to 4/3 if you prefer */
      background:#eee;
      position:relative;
    }
    .card img{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      -o-object-fit: cover;
    }

    /* empty/placeholder state if image broken */
    .card img[loading="lazy"]{ will-change: transform; }

    /* responsive breakpoints */
    @media (min-width:700px){
      .grid{ grid-template-columns: repeat(3,1fr); }
    }
    @media (min-width:1100px){
      .grid{ grid-template-columns: repeat(4,1fr); }
    }

    /* Lightbox (centered, touch friendly) */
    .lightbox{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.86);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:1200;
      padding:18px;
    }
    .lightbox.open{ display:flex; }
    .lightbox .sheet{
      width:100%;
      max-width:980px;
      max-height:92vh;
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .lightbox img{
      max-width:100%;
      max-height:92vh;
      border-radius:12px;
      object-fit:contain;
      display:block;
    }
    .lightbox .close,
    .lightbox .nav{
      position:absolute;
      top:12px;
      background:rgba(0,0,0,.35);
      color:#fff;
      border:0;
      width:44px;height:44px;border-radius:10px;
      display:inline-grid;place-items:center;font-size:20px;
      backdrop-filter: blur(4px);
      cursor:pointer;
    }
    .lightbox .close{ right:12px; top:12px; }
    .lightbox .nav.left{ left:12px; top:50%; transform:translateY(-50%); }
    .lightbox .nav.right{ right:12px; top:50%; transform:translateY(-50%); }

    /* small footer-like gap so bottom fixed buttons don't cover content */
    .bottom-spacer{ height:56px; }

    /* accessibility focus */
    a:focus, button:focus { outline:3px solid rgba(255,20,147,.18); outline-offset:3px; }

  </style>
</head>
<body>
  <div class="gallery-wrap">
    <h1 class="gallery-title">TUM Sundari TUM üì∏</h1>
    <p class="gallery-sub">Some fav snaps that make my heart go ‚Äúdhyannn‚Äù üíó</p>

    <a class="back-btn" href="/">üè† Back to Home</a>

    {% if images and images|length > 0 %}
      <div class="grid" id="grid">
        {% for img in images %}
          <article class="card" data-src="{{ img }}">
            <div class="imgwrap">
              <!-- lazy loading, onerror fallback to placeholder -->
              <img loading="lazy" src="{{ img }}" alt="photo {{ loop.index }}"
                   onerror="this.onerror=null; this.src='data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22240%22 height=%22240%22><rect width=%22240%22 height=%22240%22 fill=%22%23f3e8f1%22/></svg>'" />
            </div>
          </article>
        {% endfor %}
      </div>
    {% else %}
      <p style="color:#8b008b;">No pictures yet ‚Äî drop some into <code>static/images/</code> üìÇ</p>
    {% endif %}

    <div class="bottom-spacer" aria-hidden="true"></div>
  </div>

  <!-- Lightbox -->
  <div id="lightbox" class="lightbox" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="sheet" id="sheet">
      <button class="nav left" id="prevBtn" aria-label="Previous">‚Äπ</button>
      <img id="lightboxImg" src="" alt="Preview">
      <button class="nav right" id="nextBtn" aria-label="Next">‚Ä∫</button>
      <button class="close" id="closeBtn" aria-label="Close">‚úï</button>
    </div>
  </div>

  <script>
    // lightweight mobile-first gallery + touch support
    (function(){
      const cards = Array.from(document.querySelectorAll('.card'));
      const lightbox = document.getElementById('lightbox');
      const lbImg = document.getElementById('lightboxImg');
      const closeBtn = document.getElementById('closeBtn');
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');

      // build array of sources
      const sources = cards.map(c => c.dataset.src);

      let idx = -1;
      function open(i){
        idx = i;
        lbImg.src = sources[idx];
        lightbox.classList.add('open');
        lightbox.setAttribute('aria-hidden','false');
        // prevent background scroll on mobile
        document.body.style.overflow = 'hidden';
      }
      function close(){
        lightbox.classList.remove('open');
        lightbox.setAttribute('aria-hidden','true');
        lbImg.src = '';
        document.body.style.overflow = '';
      }
      function prev(){
        if(idx <= 0) idx = sources.length -1; else idx--;
        lbImg.src = sources[idx];
      }
      function next(){
        if(idx >= sources.length -1) idx = 0; else idx++;
        lbImg.src = sources[idx];
      }

      // attach click
      cards.forEach((c,i)=> c.addEventListener('click', ()=> open(i)));

      closeBtn.addEventListener('click', close);
      prevBtn.addEventListener('click', prev);
      nextBtn.addEventListener('click', next);

      // close on backdrop click
      lightbox.addEventListener('click', (e)=>{
        if(e.target === lightbox) close();
      });

      // keyboard
      document.addEventListener('keydown', (e)=>{
        if(lightbox.classList.contains('open')){
          if(e.key === 'Escape') close();
          if(e.key === 'ArrowLeft') prev();
          if(e.key === 'ArrowRight') next();
        }
      });

      // touch swipe for mobile
      let startX = 0, startY = 0, isTouching = false;
      lightbox.addEventListener('touchstart', (e)=>{
        if(!lightbox.classList.contains('open')) return;
        isTouching = true;
        startX = e.touches[0].clientX;
        startY = e.touches[0].clientY;
      }, {passive:true});
      lightbox.addEventListener('touchmove', (e)=>{
        if(!isTouching) return;
        // no-op (preventing accidental text-selection etc)
      }, {passive:true});
      lightbox.addEventListener('touchend', (e)=>{
        if(!isTouching) return;
        isTouching = false;
        const dx = e.changedTouches[0].clientX - startX;
        const dy = e.changedTouches[0].clientY - startY;
        if(Math.abs(dx) > 40 && Math.abs(dy) < 60){
          if(dx > 0) prev(); else next();
        }
      });

      // ensure images keep aspect ratio and no white boxes:
      // if an image fails to load, onerror sets a neutral placeholder SVG already.
    })();
  </script>
</body>
</html>
